graph TD
    %% Main Application
    Main["app/Main.hs"]
    
    %% Domain Layer
    subgraph Domain["Domain Layer"]
        DomEntMsg["Domain/Entities/Message.hs"]
        DomEntChat["Domain/Entities/Chat.hs"]
        DomIntChat["Domain/Interfaces/ChatService.hs"]
        DomIntHttp["Domain/Interfaces/HttpClient.hs"]
    end
    
    %% Application Layer
    subgraph Application["Application Layer"]
        AppIntChat["Application/Interfaces/ChatApplicationService.hs"]
        AppSvcChat["Application/Services/ChatService.hs"]
        AppSvcChatApp["Application/Services/ChatApplicationService.hs"]
    end
    
    %% Infrastructure Layer
    subgraph Infrastructure["Infrastructure Layer"]
        InfHttp["Infrastructure/Http/HttpClient.hs"]
        InfOpenAI["Infrastructure/OpenAI/OpenAIService.hs"]
    end
    
    %% Presentation Layer
    subgraph Presentation["Presentation Layer"]
        PresApi["Presentation/Api/ApiHandler.hs"]
        PresServer["Presentation/Server/Server.hs"]
    end
    
    %% Dependencies between Domain components
    DomEntChat --> DomEntMsg
    DomIntChat --> DomEntChat
    DomIntChat --> DomEntMsg
    
    %% Dependencies from Application to Domain
    AppSvcChat --> DomIntChat
    AppSvcChat --> DomEntChat
    AppSvcChat --> DomEntMsg
    AppSvcChat --> DomIntHttp
    AppSvcChatApp --> AppSvcChat
    AppSvcChatApp --> DomEntMsg
    AppSvcChatApp --> DomIntChat
    AppIntChat --> DomEntMsg
    
    %% Dependencies from Infrastructure to Domain
    InfHttp --> DomIntHttp
    InfHttp --> DomEntChat
    InfOpenAI --> DomEntChat
    InfOpenAI --> DomEntMsg
    
    %% Dependencies from Presentation to Application
    PresApi --> AppIntChat
    PresServer --> PresApi
    PresServer --> AppIntChat
    
    %% Main dependencies
    Main --> AppSvcChatApp
    Main --> AppSvcChat
    Main --> InfHttp
    Main --> PresServer